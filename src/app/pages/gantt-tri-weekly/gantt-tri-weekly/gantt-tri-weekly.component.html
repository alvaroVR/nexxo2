<div class="container-fluid finishOts my-2">
  <form [formGroup]="nivelForm" (ngSubmit)="getAll()">
    <div class="row pt-2">
      <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-2 mb-2">
        <select class="form-select form-select-sm" id="warehouseId"
                formControlName="warehouseSelect"
                (change)="getdomclientes()">
          <option [selected]="true" [value]="null" disabled>Empresa</option>
          <option *ngFor="let option of warehouseList" [value]="option.id">{{option.id}}
            - {{option.nombre}}</option>
        </select>
      </div>


      <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-2 mb-2">
        <select class="form-select form-select-sm" id="businessId"
                formControlName="businessSelect"
                (change)="getdomproyectos()">
          <option [selected]="true" [value]="null" disabled>Cliente</option>
          <option *ngFor="let option of businessList" [value]="option.id">{{option.id}}
            - {{option.nombre}}</option>
        </select>
      </div>

      <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-2 mb-2">
        <select class="form-select form-select-sm" id="deptoId"
                formControlName="projectoSelect">
          <option [selected]="true" [value]="null" disabled>Proyecto</option>
          <option *ngFor="let option of deptoList" [value]="option.id">{{option.id}}
            - {{option.nombre}}</option>
        </select>
      </div>

      <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-2 mb-2">
        <mat-form-field appearance="outline" style="max-width: 100%; font-size: 11px !important;"
        >
          <mat-date-range-input [rangePicker]="rangePicker">
            <input matStartDate formControlName="dateFromSelect" placeholder="Start date">
            <input matEndDate formControlName="dateToSelect" placeholder="End date">
          </mat-date-range-input>
          <mat-datepicker-toggle matSuffix [for]="rangePicker"></mat-datepicker-toggle>
          <mat-date-range-picker #rangePicker>
            <mat-date-range-picker-actions>
              <button mat-button matDateRangePickerCancel>Cancelar</button>
              <button mat-raised-button color="primary" matDateRangePickerApply>Aceptar</button>
            </mat-date-range-picker-actions>
          </mat-date-range-picker>
        </mat-form-field>
      </div>

      <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-2 mb-2">
        <button class="btn btn-primary btn-sm" type="submit">Buscar</button>
      </div>
      <div class="col-12 col-sm-12 col-md-2 col-lg-2 col-xl-2 mb-2 text-end">

        <button type="button" mat-raised-button class="btn-sm btn-primary" *ngIf="rowData && columnDefs" (click)="expandAll()">{{txtButton}}</button>
        <button type="button" mat-raised-button class="btn-sm btn-primary" (click)="addOt()">OT</button>
        <button type="button" mat-raised-button class="btn-sm btn-primary" *ngIf="rowData && columnDefs" (click)="refresh()">Refresh</button>
      </div>
    </div>


  </form>
</div>
<div class="container-fluid" *ngIf="rowData && columnDefs">
  <mat-accordion class="example-headers-align" multi>
    <mat-expansion-panel [disabled]="true" id="1" (opened)="test($event)"
                         (closed)="test($event)">
      <mat-expansion-panel-header>
      </mat-expansion-panel-header>

      <div class="row" *ngIf="programablesData">
        <div class="col-md-5" *ngIf="false">
          <mat-card class="p-1" style="height: 100%">
          </mat-card>
        </div>
        <div class="col-md-12">
          <mat-card class="p-1">
            <mat-tab-group [(selectedIndex)]="tabIndex">
              <mat-tab label="Programables">
                <app-programables-gla-tw [rowData]="programablesData" [formulario]="nivelForm"
                                         [rowNodeData]="rowNodeData"
                                         (refreshTable)="refreshProgramables($event)"
                                         (setSearchGrid)="getDet2GantChartProgram($event)"
                ></app-programables-gla-tw>
              </mat-tab>
              <!--mat-tab label="Requisitos">
                <app-requisitos-gla-tw [rowData]="requisitos"></app-requisitos-gla-tw>
              </mat-tab-->
              <mat-tab label="Causas DNC">
                <app-causas-gla-tw [rowData]="causas" [formulario]="nivelForm"></app-causas-gla-tw>
              </mat-tab>
              <mat-tab label="Causas Exceso">
                <app-causas-exceso [rowData]="causasExceso" [formulario]="nivelForm"></app-causas-exceso>
              </mat-tab>
              <mat-tab label="Causas Calidad">
                <app-causas-calidad-tab [rowData]="causasCalidad" [formulario]="nivelForm"></app-causas-calidad-tab>
              </mat-tab>
            </mat-tab-group>
          </mat-card>
        </div>
      </div>

    </mat-expansion-panel>
    <mat-expansion-panel [expanded]="true" class="p-0">
      <mat-expansion-panel-header>
      </mat-expansion-panel-header>
      <div *ngIf="rowData && columnDefs">
        <app-chart-gantt-tw [rowData]="rowData"
                            [columnDefs]="columnDefs"
                            [height]="height"
                            [turnoList2]="turnoList"
                            (refreshTable)="updateGantt2()"
                            [dayColSet]="dayColSet"
                            [listOwner]="listOwner"
                            [formulario]="nivelForm"
                            (closeSwal)="closeSwal()"
                            [subpartidas]="subpartidas"
                            (reloadTableEmit)="updateGanttFUll()"
                            (setTabIndex)="setTabIndex($event)"

                            (realoadCausas)="getDetCausasNoCumpltoTaskGanttTriWeekly($event)"
                            (realoadCalidad)="getDetCausasCalidadTaskGanttTriWeekly($event)"
                            (realoadExceso)="getDetCausasExcesosTaskGanttTriWeekly($event)"
                            (rowNodeSelected)="getDetRequesitosCategoryGantt($event)"
                            (realoadRequisitos)="getDetRequesitosCategoryGantt($event)"
        ></app-chart-gantt-tw>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</div>
